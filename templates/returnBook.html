{% extends "layout.html" %}

{% block title %}
    Return Book
{% endblock %}

{% set actionUrl = '/return-book' %}

{% block pageTitle %}
    Return book
{% endblock %}

{% block formContent %}
    <div class="flex items-center">
        <label for="reader_id" class="w-40 font-medium">Reader ID:</label>
        <input
            type="number"
            name="reader_id"
            id="reader_id"
            placeholder="Enter reader ID"
            class="ml-2 p-1 border border-gray-300 rounded w-64"
            required
        >
    </div>

    <button
        type="submit"
        class="mt-4 px-4 py-2 bg-blue-500 hover:bg-blue-500/80 active:bg-blue-500/60 duration-100 text-white rounded cursor-pointer"
    >
        Search Loans
    </button>
{% endblock %}

{% block main %}

    {% if error %}
        <span class="text-red-400">{{ error }}</span>
    {% endif %}

    <hr>

    {% if reader_name %}
        <p>Reader name: {{ reader_name }}</p>
        <p>Loan Books:</p>
        
        {% if loan_books %}
            <table class="table-auto w-[85] border-collapse border border-gray-300 mt-4">
                <thead class="bg-zinc-600 text-white">
                    <tr>
                        <th class="border border-gray-300 px-4 py-2">Loan Record ID</th>
                        <th class="border border-gray-300 px-4 py-2">Reader ID</th>
                        <th class="border border-gray-300 px-4 py-2">Book ID</th>
                        <th class="border border-gray-300 px-4 py-2">Book Title</th>
                        <th class="border border-gray-300 px-4 py-2">Book Location ID</th>
                        <th class="border border-gray-300 px-4 py-2">Loan Date</th>
                        <th class="border border-gray-300 px-4 py-2">Due Date</th>
                        <th class="border border-gray-300 px-4 py-2 text-center">Return</th>
                    </tr>
                </thead>
                <tbody>
                    {% for loan_book in loan_books %}
                    <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-100{% endif %}">
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[0] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[1] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[2] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[3] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[4] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[5] }}</td>
                        <td class="border border-gray-300 px-4 py-2">{{ loan_book[6] }}</td>
                        <td class="border border-gray-300 px-4 py-2 text-center">
                            <form action="/return-book/confirm" method="POST">
                                <input type="hidden" name="loan_record_id" value="{{ loan_book[0] }}">

                                <button
                                type="submit"
                                class="inline-flex items-center justify-center w-6 h-6 rounded-full border border-red-500 text-red-500 hover:cursor-pointer hover:bg-red-500 hover:text-white active:bg-red-500/60 duration-100"
                                title="Return this book"
                                >
                                <span class="block w-3 h-0.5 bg-current rounded"></span>
                                </button>
                            </form>
                        </td>
                    </tr>

                    {% endfor %}
                    </tbody>
                </table>

        {% else %}
            <p class="text-lg">There's no loan book from the reader</p>
        {% endif %}
    {% endif %}
    
{% endblock %}
