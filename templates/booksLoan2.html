{% extends "layout.html" %}

{% block title %}
    loan book
{% endblock %}

{% set actionUrl = '/loan-book/loan' %}

{% block pageTitle %}
    {% if name %}
      Welcome {{ name }}
    {% endif %}
{% endblock %}

{% block formContent %}
  <form method="post">
    <div class="flex items-center mt-4">
      <label for="ISBN" class="w-40 font-medium">ISBN:</label>
      <input type="text" name="ISBN" id="ISBN"
        placeholder="Enter ISBN"
        class="ml-2 p-1 border border-gray-300 rounded w-64">
        <input type="hidden" name="name" value="{{ name }}">
    </div>
    <button type="submit"
      class="mt-4 px-4 py-2 bg-blue-500 text-white rounded">
      Search
    </button>
  </form>
{% endblock %}

{% block main %}
  {% if SearchFail %}
      <span class="text-red-400">{{ SearchFail }}</span>
    {% endif %}
      {% if name %}
        {% if book_info %}
          <table class="table-auto w-[85] border-collapse border border-gray-300 mt-4">
            <thead class="bg-zinc-600 text-white">
              <tr>
                <th class="border px-4 py-2">Book ID</th>
                <th class="border px-4 py-2">ISBN</th>
                <th class="border px-4 py-2">Book Title</th>
                <th class="border px-4 py-2">Author</th>
                <th class="border px-4 py-2">Category</th>
                <th class="border px-4 py-2">Publisher</th>
                <th class="border px-4 py-2">Location District</th>
                <th class="border px-4 py-2">Book Shelf</th>
                <th class="border px-4 py-2">Shelf Level</th>
                <th class="border px-4 py-2">Loan</th>
              </tr>
            </thead>
            <tbody>
              {% for row in book_info %}
                <tr class="{% if loop.index0 % 2 == 0 %}bg-white{% else %}bg-gray-100{% endif %}">
                  <td class="border px-4 py-2">{{ row[0] }}</td>
                  <td class="border px-4 py-2">{{ row[1] }}</td>
                  <td class="border px-4 py-2">{{ row[2] }}</td>
                  <td class="border px-4 py-2">{{ row[3] }}</td>
                  <td class="border px-4 py-2">{{ row[4] }}</td>
                  <td class="border px-4 py-2">{{ row[5] }}</td>
                  <td class="border px-4 py-2">{{ row[6] }}</td>
                  <td class="border px-4 py-2">{{ row[7] }}</td>
                  <td class="border px-4 py-2">{{ row[8] }}</td>
                  <td class="border px-4 py-2 text-center">
                    <form action="/loan-book/finish" method="POST">
                      <input type="hidden" name="name" value="{{ name }}">
                      <input type="hidden" name="book_id" value="{{ row[0] }}">
                      <button type="submit"
                        class="inline-flex items-center justify-center w-6 h-6 rounded-full border border-green-500 text-green-500 hover:bg-green-500 hover:text-white"
                        title="loan this book">
                        +
                      </button>
                    </form>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% endif %}
      {% endif %}  
{% endblock %}